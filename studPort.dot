digraph {

    //nodesep=1
    //concentrate=true;
    //[tailport=n];
    constraint=true;

        ratio=fill
        graph[margin="1,1"]
        ranksep = 1
        rankdir = LR
        //graph [layout = twopi]

        edge[sametail=t1];
        //node [headport=sw];
        nodesep=0.05
        ranksep = 0.2
        fixedsize=true
        //K=10
        //[splines=ortho, overlap = false];
        //graph [splines="ortho", nodesep = "0.01", overlap = prism];
        //overlap=prism;
        //arrowsize=10.0
        //splines=true
        node [fontname="Latin Modern Sans", fontsize=15]
        fontname="Latin Modern Sans"

        node [style="solid,filled"]
        //edge[penwidth=1.5];

        subgraph Legend {
        ordering=out

          //tailport=se
            node [pin=true]
            label = "Teckenförklaring"
            style=tapered;
            penwidth=0;
            color=lightgrey;
            DM2 [fillcolor = "#68E331", label="Master CSN", penwidth=0, pos="1,2!", pin=true]
            DM1 [fillcolor = "#E33D31", label="Master CSALL", penwidth=0]
            D3 [fillcolor = "#BC4BEC", label="Årskurs 3", penwidth=0]
            D2 [fillcolor = "#20B2AA", label="Årskurs 2", penwidth=0]
            D1 [fillcolor = "#ACC5F6", label="Årskurs 1", penwidth=0]

            Valbar [style="dashed", penwidth=2]
            Obligatorisk [style="solid"]
        }

        subgraph Fulhack {
            node[shape=none, width=1, height=0, label="",  style=invis];
            edge[dir=none, style=invis];
            L1 ->L1
        }


        subgraph TKDAT1 {
          //concentrate=true;
            label = "TKDAT-1"
                // rank = same

                node [fillcolor="#ACC5F6"]
                haskell  [label = "Funktionell\nprogrammering"]
                diskmat  [label = "Diskret\nmatematik"]
                linalg   [label = "Linjär\nalgebra"]
                digodat  [label = "Grundläggande\ndatorteknik"]
                analys   [label = "Matematisk\nanalys"]
                mop      [label = "Programmering av\ninbyggda system"]
                datakom  [label = "Data-\nkommunikation"]
                oop      [label = "Objektorienterad\nprogrammering"]
        }
        //edge[sametail=t1,samehead=h1]
            diskmat -> linalg
            diskmat -> datakom
            digodat -> datakom
            oop     -> datakom //
            diskmat -> analys




            subgraph TKDAT2 {
            //edge[samehead=h2, sametail=t2];
            //edge[sametail=t2];
            tailport=se
                label = "TKDAT-2"
                    // rank = same
                    node [fillcolor="#FFD942"]
                    matstat  [label = "Matematisk\nstatistik"]
                    fysik    [label = "Fysik för\ningenjörer"]
                    dstrukt  [label = "Datastrukturer"]
                    syntes   [label = "Digital konstruktion"]
                    dtekproj [label = "Datatekniskt\nprojekt"]
                    el       [label = "Elektriska kretsar &\nfält"]
                    subgraph {
                        node [style="dashed, filled", penwidth=2]
                        matdom     [label = "Matematikens domän-\nspecifika språk"]
                        concurrent [label = "Parallell\nprogrammering"]
                    }
                    dst      [ label = "Datorsystem-\nteknik"]
            }

            //edge[sametail=t2,samehead=h2];
            mop     -> dtekproj
            digodat -> dtekproj
            diskmat -> matstat
            linalg -> matstat
            analys -> matstat

            diskmat -> dstrukt
            oop -> dstrukt
            linalg -> fysik
            analys -> fysik

            subgraph TKDAT3 {
                label = "TKDAT-3"
                    // rank = same
                    node [fillcolor = "#BC4BEC"]
                    tss      [label = "Transformer, signaler\noch system"]
                    regler   [label = "Reglerteknik"]
                    kandidat [label = "Kandidatarbete"]
                    barsaft  [label = "Miljökurs"]
                    mts      [label = "MTS-kurser"]
                    subgraph {
                        node [style="dashed, filled", penwidth=2]
                        elektronik [label="Elektronik"]
                        databas    [label="Databaser"]
                        flervar    [label = "Analys i\nflera variabler"]
                        digkonstr  [label = "Digital-\nkonstruktion, projektkurs"]
                        fysik2     [label = "Fysik 2"]
                        web        [label = "Web-applikationer"]
                        deskonstr  [label = "Design/konstruktion\nav grafiska gränssnitt"]
                    }
            }
            //edge[sametail=t2,samehead=h2]


            subgraph CSALL {

                label = "CSALL"
                    // rank = same
                    node [fillcolor="#E33D31"]
                    prolang    [label = "Programming\nlanguage tech"]
                    algoritmer [label = "Algorithms"]
                    logik      [label = "Logic in CS"]
                    cscience   [label = "The Computer Scientist\nin Society"]

                    // Valbara
                    subgraph {
                        node [style="dashed, filled", penwidth=2]
                        advAlg   [label = "Advanced\nalgorithms"]
                        discopt  [label = "Discrete optimization"]
                        ml       [label = "Machine learning"]
                        ai       [label = "Artifical intelligence"]
                        models   [label = "Models of computation"]
                        types    [label = "Types for programs\nand proofs "]
                        softEng  [label = "Software eng.\nusing formal meth."]
                        compilerConst [label="Compiler construction"]
                        advFunc  [label = "Advanced\nfunc. prog"]
                        paraFunc [label = "Parallel functional\nprogramming"]
                        crypto   [label = "Cryptography"]
                        langsecurity [label = "Language-based\nsecurity"]
                    }
            }

            subgraph CSN {
                node [fillcolor="#68E331"]
                computerNetworks [label="Computer networks"]
                oS [label="Operating systems"]
                ftcs [label="Fault tolerant\ncomputer systems"]
                techwrite [label = "Tech. writing\nin CSN"]

                // Valbara
                subgraph {
                    node [style="dashed, filled", penwidth=2]
                    advDistSys [label="Advanced\ndistributed systems"]
                    networkSecurity [label="Network security"]
                    computerSecurity [label="Computer security"]
                    rts [label="Real time\nsystems"]
                    parallelOrganization [label="Parallel computer\norganization and design"]
                    parallelRTS [label="Parallel and distributed\nreal-time systems"]
                    distSys [label="Distributed systems"]
                    energyComp [label="Energy aware\ncomputing"]
                    routerSwitch [label="Router- och\nswitchteknik"]
                    commEng [label="Introduction to\ncommunication engineering"]
                    compArch [label="Computer architecture"]
                }
            }


//                lolnode [label="", image="sndlogo.svg"]


}
